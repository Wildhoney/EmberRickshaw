/*! EmberRickshaw by Adam Timberlake created on 2013-07-20 */
Rickshaw.Graph.Ember=function(a){function b(a,b){this.collection=a,this.properties=b,this.setupObservers()}function c(a){this.options=a}Ember.assert("You must supply a valid `collection` array in the `data` attribute.",!!a.collection),Ember.assert("You must specify the `property` string in the `series` attribute.",!!a.series[0].property);var d=a.collection,e=this.memoriseProperties(a);if(delete a.collection,!d||0===e.length||!a.series[0].property)return{onUpdate:function(){},render:function(){console.error("Unable to render the graph because you're either missing the `collection` and/or `property` attribute.")}};this.transformData.apply(a.series,[d,e]),Ember.isNone(a.element)&&(a.element=document.createElement("div"),Ember.Logger.info("We're using Rickshaw in testing mode and therefore nothing will be visible."));var f=new Rickshaw.Graph(a);return c.prototype=f,b.prototype=new c(a),c.prototype.rickshaw=f,b.prototype.transformData=Rickshaw.Graph.Ember.prototype.transformData,b.prototype.render=function(){this.transformData.apply(this.options.series,[this.collection,this.properties]);var a=$(this.element),b=a.find("svg"),c=a.find(".no-data");return 0===this.count()?(b.hide(),c&&c.show(),void 0):(b.show(),c&&c.hide(),this.rickshaw.render(),void 0)},b.prototype.count=function(){var a=0;for(var b in this.options.series)this.options.series.hasOwnProperty(b)&&isFinite(b)&&(a+=this.options.series[b].data.length);return a},b.prototype.ticks=function(a,b){var c=this.collection.mapProperty(b);return c[a]},b.prototype.setupObservers=function(){for(var a in this.properties)this.properties.hasOwnProperty(a)&&Ember.addObserver(this.collection,"@each.%@".fmt(this.properties[a]),this,"render");Ember.addObserver(this.collection,"length",this,"render")},new b(d,e)},Rickshaw.Graph.Ember.prototype={memoriseProperties:function(a){var b=[];for(var c in a.series)if(a.series.hasOwnProperty(c)){var d=a.series[c].property||null;d||console.error("Unable to locate the `property` attribute in series: %@.".fmt(c)),b.push(d)}return b},transformData:function(a,b){var c=[];return b.forEach(function(b,d){var e=[];a.forEach(function(a,c){var d=parseFloat(b?a.get(b):!1);d=isNaN(d)?0:d,b&&!a.get(b)&&console.error("Unable to locate the `%@` property in collection.".fmt(b)),e.push({x:c,y:d})},this),this[d].data=e,c.push(e)},this),c}};